const KintoneTools={const:{round:{round:0,ceil:1,floor:2}},createUniqNumber:function(){return Number((new Date).getTime().toString()+KintoneTools.padding(Math.floor(1e3*Math.random()),3))},createZeroFillNextValue:function(records,field,len){let nextVal=1;return 0!==records.length&&(nextVal=Number(records[0][field].value)+1),KintoneTools.padding(nextVal,len)},createNextUid:function(records){let nextUid=1;return 0!==records.length&&(nextUid=Number(records[0].uid.value)+1),nextUid},setNextUid:function(record,records){record.uid.value=KintoneTools.createNextUid(records)},setRecordTitle:function(record,fields){record.record_title.value=KintoneTools.joinFieldValue(record,fields)},setRecordTitleByValue:function(record,values,delimiter){let strDelimiter=delimiter||" ";record.record_title.value=values.join(strDelimiter)},setLookupKey:function(record,fields){record.lookup_key.value=KintoneTools.joinFieldValue(record,fields)},setLookupKeyByValue:function(record,values,delimiter){let strDelimiter=delimiter||" ";record.lookup_key.value=values.join(strDelimiter)},joinFieldValue:function(record,fields,delimiter){let strDelimiter=delimiter||" ",retStr="";return fields.forEach((function(val){record[val].value&&(retStr+=record[val].value+strDelimiter)})),retStr=retStr.slice(0,-1),retStr},commaSeparate:function(num){return String(num).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")},padding:function(num,len,fillStr){let str,base;return((fillStr||"0").repeat(len)+num).slice(-1*len)},rounding:function(num,type,digit){digit=-1*digit||0;let ret=num*Math.pow(10,digit);switch(type){case KintoneTools.const.round.round:ret=Math.round(ret);break;case KintoneTools.const.round.ceil:ret=Math.ceil(ret);break;case KintoneTools.const.round.floor:ret=Math.floor(ret);break;default:ret=Math.round(ret)}return ret/=Math.pow(10,digit),ret},getQueryToObject:function(strParam){let objRet={},aryParams;return strParam.split("&").forEach((function(val){let aryTmp=val.split("=");objRet[aryTmp[0]]=aryTmp[1]})),objRet},getId:function(){return KintoneTools.getThisAppId()},getThisAppId:function(){let thisAppId=-1;return KintoneTools.isPcMode()&&(thisAppId=kintone.app.getId()),KintoneTools.isMobileMode()&&(thisAppId=kintone.mobile.app.getId()),thisAppId},getSpaceElement:function(id){let elm=null;return KintoneTools.isPcMode()&&(elm=kintone.app.record.getSpaceElement(id)),KintoneTools.isMobileMode()&&(elm=kintone.mobile.app.record.getSpaceElement(id)),elm},getRelatedRecordsTargetAppId:function(fieldCode){let appId=-1;return KintoneTools.isPcMode()&&(appId=kintone.app.getRelatedRecordsTargetAppId(fieldCode)),KintoneTools.isMobileMode()&&(appId=kintone.mobile.app.getRelatedRecordsTargetAppId(fieldCode)),appId},getLookupTargetAppId:function(fieldCode){let appId=-1;return KintoneTools.isPcMode()&&(appId=kintone.app.getLookupTargetAppId(fieldCode)),KintoneTools.isMobileMode()&&(appId=kintone.mobile.app.getLookupTargetAppId(fieldCode)),appId},getRecord:function(){let objRecord=null;return KintoneTools.isPcMode()&&(objRecord=kintone.app.record.get()),KintoneTools.isMobileMode()&&(objRecord=kintone.mobile.app.record.get()),objRecord},setRecord:function(objRecord){KintoneTools.isPcMode()&&kintone.app.record.set(objRecord),KintoneTools.isMobileMode()&&kintone.mobile.app.record.set(objRecord)},getQueryCondition:function(){let condition=null;return KintoneTools.isPcMode()&&(condition=kintone.app.getQueryCondition()),KintoneTools.isMobileMode()&&(condition=kintone.mobile.app.getQueryCondition()),condition},getQuery:function(){let query=null;return KintoneTools.isPcMode()&&(query=kintone.app.getQuery()),KintoneTools.isMobileMode()&&(query=kintone.mobile.app.getQuery()),query},getContentSpaceElement:function(){let elm=null;return KintoneTools.isPcMode()&&(elm=kintone.portal.getContentSpaceElement()),KintoneTools.isMobileMode()&&(elm=kintone.mobile.portal.getContentSpaceElement()),elm},isPcMode:function(){let ret=!1;return null==kintone.app.getId()&&null==kintone.portal.getContentSpaceElement()||(ret=!0),ret},isMobileMode:function(){let ret=!1;return null==kintone.mobile.app.getId()&&null==kintone.mobile.portal.getContentSpaceElement()||(ret=!0),ret},getAge:function(bd){let age=-1,arrBd=bd.split("-"),birthday=new Date(arrBd[0],arrBd[1]-1,arrBd[2]),today=new Date,thisYearBirthday=new Date(today.getFullYear(),birthday.getMonth(),birthday.getDate());return age=today.getFullYear()-birthday.getFullYear(),today<thisYearBirthday&&age--,age},getIds:async(appId,condition,orderBy,guestSpaceId)=>{const aryRet=[],client_param={};guestSpaceId&&(client_param.guestSpaceId=guestSpaceId);try{const client=new KintoneRestAPIClient(client_param),resp=await client.record.getAllRecords({app:appId,fields:["$id"],condition:condition||"",orderBy:orderBy||""}).then((function(resp){return resp})).catch((function(error){return console.log(error),Promise.reject(new Error("GET : "+appId+" / "+error.message))}));console.log(resp),resp.map(val=>val.$id.value).forEach(val=>aryRet.push(Number(val)))}catch(error){console.log(error)}finally{return aryRet}},log2kintone:async objError=>{try{const client=new KintoneRestAPIClient,resp=await client.record.addRecord({app:objError.appId,record:{"エラーメッセージ":{value:objError.message},"エラーオブジェクト":{value:objError.object},stack_trace:{value:function(){const obj={};return Error.captureStackTrace(obj,arguments.callee),obj.stack}()},"マーク":{value:objError.mark}}}).then((function(resp){return console.log(resp),resp})).catch((function(error){return console.log(error),Promise.reject(new Error("POST : "+objError.appId+" / "+error.message))}));console.log(resp)}catch(error){console.log(error)}}};String.prototype.repeat||(String.prototype.repeat=function(len){return Array(len+1).join(this)});